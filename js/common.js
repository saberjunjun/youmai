/*!grunt_test-1.0.0.js 2016-12-20 */
function Rolling(a){this.index=++a.index||1,this.num=a.num||1,this.obj=a.obj||null,this.perObj=a.perObj||null,this.nextObj=a.nextObj||null,this.focusPoint=a.focusPoint||null,this.focusClass=a.focusClass||"mien-active",this.replaceBtn=a.replaceBtn||!1,console.log(a.replaceBtn),this.listLength=Math.ceil(a.obj.find("li").length/this.num),this.listObj=a.obj.children("li"),this.listWidth=this.listObj.width()+parseInt(this.listObj.css("margin-left"))+parseInt(this.listObj.css("margin-right")),this.init()}function createRolling(a){return new Rolling(a)}var _hmt=_hmt||[];!function(){var a=document.createElement("script");a.src="//hm.baidu.com/hm.js?09296d797105fe1b8fc3ac57feac05a6";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}();var dataUrl={getUrlVal:function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),c=window.location.search.substr(1).match(b);return c?decodeURIComponent(c[2]):null},getUrlString:function(){var a=window.location.href.split("/"),b=a[a.length-1],c=b.indexOf(".");return b.substr(0,c)}};Rolling.prototype.init=function(){var a=this;this.initLeft(),this.replaceFun(),null!==this.focusPoint&&this.createFocusPoint(),this.perObj.unbind("click").on("click",function(){a.rollPrev()}),this.nextObj.unbind("click").on("click",function(){a.rollNext()})},Rolling.prototype.createFocusPoint=function(){for(var a="",b=this,c=0;c<this.listLength;c++)a+=c==this.index-1?'<li class="'+this.focusClass+'"></li>':"<li></li>";this.focusPoint.append(a),this.focusPoint.children().click(function(){var a=$("."+b.focusClass).index()+1,c=$(this).index()+1,d=c-a,e=b.perObj.find("img"),f=b.nextObj.find("img");1!=c||b.replaceBtn?c!=b.listLength||b.replaceBtn?b.replaceBtn||(e.attr("src",e.attr("re-src")),f.attr("src",f.attr("data-src"))):(e.attr("src",e.attr("re-src")),f.attr("src",f.attr("re-src"))):(e.attr("src",e.attr("data-src")),f.attr("src",f.attr("data-src"))),b.index+=d,d>0&&b.obj.animate({marginLeft:"-="+Math.abs(d)*b.num*b.listWidth+"px"}),d<0&&b.obj.animate({marginLeft:"+="+Math.abs(d)*b.num*b.listWidth+"px"}),$(this).addClass(b.focusClass).siblings().removeClass(b.focusClass)})},Rolling.prototype.initLeft=function(){1!=this.index&&this.obj.css("margin-left",-(this.index-1)*this.listWidth)},Rolling.prototype.rollPrev=function(){return--this.index,this.index<=1&&!this.replaceBtn&&this.perObj.find("img").attr("src",this.perObj.find("img").attr("data-src")),this.thisIndex()?(this.replaceBtn||this.nextObj.find("img").attr("src",this.nextObj.find("img").attr("data-src")),this.obj.animate({marginLeft:"+="+this.num*this.listWidth+"px"}),void(null!==this.focusPoint&&$("."+this.focusClass).removeClass(this.focusClass).prev().addClass(this.focusClass))):void++this.index},Rolling.prototype.rollNext=function(){return++this.index,this.index!=this.listLength||this.replaceBtn||this.nextObj.find("img").attr("src",this.nextObj.find("img").attr("re-src")),this.thisIndex()?(this.replaceBtn||this.perObj.find("img").attr("src",this.perObj.find("img").attr("re-src")),this.obj.animate({marginLeft:"-="+this.num*this.listWidth+"px"}),void(null!==this.focusPoint&&$("."+this.focusClass).removeClass(this.focusClass).next().addClass(this.focusClass))):void--this.index},Rolling.prototype.replaceFun=function(){var a=this.perObj.find("img"),b=this.nextObj.find("img"),c=a.attr("src"),d=b.attr("src");a.attr({"data-src":c,"re-src":this.splitSrc(c)}),b.attr({"data-src":d,"re-src":this.splitSrc(d)})},Rolling.prototype.splitSrc=function(a){var b=a.split("/"),c=b[b.length-1],d=c.substr(0,c.indexOf("."));return a.replace(d,"re-"+d)},Rolling.prototype.thisIndex=function(){return!(this.index>this.listLength||this.index<=0)};